<!doctype html>
<html lang="en" class="h-100">

<head>
    <% include ../views/include/head %>
</head>

<body class="d-flex flex-column h-100">
    <% include ../views/include/nav %>
    <main role="main" class="flex-shrink-0 mt-5">
        <div class="container">
            <h1><%= title %></h1>
            <div class="row">
                <div class="col">
                    <ul>
                        <li>api url: <span class="edit-content" id="config-apiurl" contenteditable="true"><%- config.sawtooth.apiurl %></span> <button class="btn btn-sm btn-outline-success" id="save-config-apiurl">SAVE</button></li>
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-2">
                <button class="btn btn-sm btn-outline-success" id="reload-website">Reload (pm2)</button>
                </div>
            </div>
        </div>
    </main>
    <% include ../views/include/footer %>
    <script>
    $("#save-config-apiurl").click(function() {
        $.ajax({
            type: "POST",
            url: window.location.href + "/apiurl",
            data: {
                apiurl: $("#config-apiurl").text()
            },
            dataType: "json",
            success: function (data) {
                window.location.reload();
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                return alert("ERROR");
            }
        });
    })
    $("#reload-website").click(function() {
        $.ajax({
            type: "POST",
            url: window.location.href + "/reload-website",
            data: {},
            dataType: "json",
            complete: function (data) {
                setTimeout(function(){
                    window.location.reload();
                }, 2000);
            }
        });
    })
    </script>
</body>
</html>